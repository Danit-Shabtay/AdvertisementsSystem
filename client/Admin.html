<!DOCTYPE html>
<html lang="en">
  
<head>
    <meta charset="UTF-8">
    <title>Admin Page</title>
    <!-- INCLUDING JQUERY-->
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <link rel="stylesheet" href="style.css">

</head>
  
<body>
    <section>
        <h1>Advertisements System-Admin Page</h1>
        <br>
        <h1>The Advertisements</h1>
        <table id='adsTable'>
            <tr>
              <th>Name</th>
              <th>Screen Number</th>
              <th>Template</th>
              <th>Length</th>
              <th>Starting Date</th>
              <th>Ending Date</th>
              <th>Starting Time</th>
              <th>Ending Time</th>
            </tr>
        </table>
            <br>
            <h1>All Screens- sorted by last connection time</h1>
            <table id='screensTable'>
                <tr>
                  <th>Screen Number</th>
                  <th>Last Connection Date And Time</th>
                </tr>
            </table>
            <br>
  
            <script>
              const SERVER="localhost:3000";
              $(document).ready(function () {
              fetch('http://'+SERVER+"/advertisment?id=0")
               .then(response =>response.json())
               .then(function(data){
                var content = '';
                  for(var i=0;i<data.length;i++){
                    //Construction of rows having data from json object
                    content += '<tr>';
                    content+='<td><a href="https://google.com">'+data[i].name+'</a></td>'
                    content += '<td>' + data[i].screenId + '</td>'; 
                    content += '<td>' + data[i].template + '</td>'; 
                    content += '<td>' + data[i].length + '</td>';
                    content += '<td>' + new Date(data[i].timeFrame[0].dates.start).toLocaleDateString() + '</td>';
                    content += '<td>' + new Date(data[i].timeFrame[0].dates.end).toLocaleDateString() + '</td>'; 
                    content += '<td>' + new Date(data[i].timeFrame[0].time.start).toLocaleTimeString() + '</td>';
                    content += '<td>' + new Date(data[i].timeFrame[0].time.end).toLocaleTimeString() + '</td>'; 
                    content += '</tr>';
                  }
                  //Inserting rows into table 
                  $('#adsTable').append(content);
                })
              })

              fetch('http://'+SERVER+"/screens")
               .then(response =>response.json())
               .then(function(data){
                var content = '';
                  for(var i=0;i<data.length;i++){
                    //Construction of rows having data from json object
                    content += '<tr>';
                    content += '<td>' + data[i]._id + '</td>';
                    const date=new Date(data[i].lastConnection);
                    content += '<td>' + date.toLocaleDateString()+" "+date.toLocaleTimeString()+ '</td>';
                    content += '</tr>';
                  }
                  //Inserting rows into table 
                  $('#screensTable').append(content);
                })
            </script>
    </section>
</body>

</html>
